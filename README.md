# ExGherkin

Elixir implementation for `Gherkin`-language.

Status: Feature-complete but still more documentation work required.

The purpose of this project is to be at least functionally equivalent to
the [official `ruby` implementation](https://github.com/cucumber/cucumber/tree/master/gherkin/ruby).
In order to realize this, detailed tests have been implemented to compare
the output generated by the official tools with the output generated in
the tests.

This project is intentionally coined in its own dedicated `repo` to facilitate others; such as `white_bread` and `cabbage`, to leverage this `parser` if need be.

## Road Forward
* [ ] Introduce more detailed documentation:
    * [ ] Better examples as to how to effectively use this parser
    * [ ] Create online documentation to clarify `Syntax`-errors
    * [ ] Provide a detailed account of the various tests implemented
    that are to proof that this is functionally equivalent to the `ruby`-
    implementation.
* [ ] Take feedback from the official team to have this `repo`to be
included in the [mono-repo](https://github.com/cucumber/cucumber)
eventually.
* [ ] CI/CD.
* [ ] Implement `Cucumber` using this tool.
* [ ] Publish to Hex.

## Tools

1. Mix tasks:
    1. `mix gherkin_languages`:
       * input: `gherkin-languages.json`
       * output: `gherkin-languages.terms`
       * supply variety of options to control:
         * which subset of languages desired
         * homonyms
    2. `mix ast_ndjson`:
       * input: `*.feature`
       * output: `*.feature.ast.ndjson`
       * dependency: `gherkin`-executable
2. `generate-tokens`:
   * input: `*.feature`
   * output: `*.feature.tokens`
   * dependency: `gherkin`-executable

The dependency referred to above can be installed by:
* `gem install cucumber`

## API
```elixir
"""
Feature: Minimal

  Scenario: minimalistic
    Given the minimalism

"""
|> ExGherkin.prepare
|> ExGherkin.run
```

```elixir
[path: "path_to.feature"]
|> ExGherkin.prepare
|> ExGherkin.run
```

For fine granular control, there are two parts:

1. `Scanner.tokenize/1,2` to tokenize the `feature` file. This leverages
`gherkin-languages.terms` to provide `i18n`-support. This file is
reproducible with the aid of the `mix`-task briefly docummented above,
e.g.: `mix gherkin_languages`. Using this task, one can use a subset
of what is contained under [gherkin-languages.json](https://github.com/cucumber/cucumber/blob/master/gherkin/gherkin-languages.json) and/or to even incorporate one's own domain-
language specific keywords to denote `Given`, `When`, `Then` etc. An
example of this is the file: `gherkin-languages.few.terms` which was
primarily introduced to bring the compile-time of this project down.
`Scanner.tokenize/1,2` [effectively iterates](https://github.com/Ajwah/ex-gherkin/blob/aa32dad70911cf5a7ead186a944dedafc10e2dd1/lib/scanner/scanner.ex#L59-L62) over this file,
generating functions that pattern-match `i18n`-support.

2. `Parser.run/1` to convert the tokens obtained into `AST`-tree.
Leverages `yecc` parser under the hood.


Kindly consult the test-files for more detailed usage.

## Configuration
`config.exs` provides you with config options that mainly relate to the
`mix`-tasks listed above, including usage of the `terms`-file:
`gherkin-languages.few.terms`